{"version":3,"file":"src_components_Auth_OauthCallback_tsx.bundle.js","mappings":"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","sources":["webpack://newwebsite/./src/api/auth/tokenLogin.ts","webpack://newwebsite/./src/components/Auth/OauthCallback.tsx"],"sourcesContent":["import { config } from '../../config/config';\nimport http from '../http';\n\n\nconst tokenLogin = (token: string ): Promise<any> => {\n  return new Promise<any>((resolve, reject) => {\n    http\n      .post(`${config.privateapilink}/auth/tokenlogin`, { token })\n      .then((data) => resolve(data))\n      .catch(reject);\n  });\n};\n\nexport default tokenLogin;","import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport useSWR from 'swr';\nimport { fetcher } from '../../api/http';\nimport tokenLogin from '../../api/auth/tokenLogin';\nimport { toast } from 'react-toastify';\nimport Login from './Login';\nimport Loading from '../Elements/Loading';\nimport { config } from '../../config/config';\nimport { useDark } from '../../App';\n\nconst OauthCallback = () => {\n    const {dark} = useDark();\n    const [loading, setLoading] = useState(false);\n    const navigate = useNavigate();\n    const urlParams = new URLSearchParams(window.location.search);\n    const type = urlParams.get('type');\n    const code = urlParams.get('code');\n    const {data, error, isLoading} = useSWR(`${config.privateapilink}/auth/oauthloginCallback?token=${code}&type=${type}`, fetcher);\n    if(!data || (error || isLoading)) {\n        return <Loading/>;\n    }\n    if(data['status'] === 'error' || !data.data) {\n        let message = '';\n        if(data['status'] !== 'error') {\n            message = 'A unexcepted error happend.';\n        } else {\n            message = data['message'];\n        }\n        return (\n            <Login loginError={message}/>\n        );\n    }\n    const sendLogin = (token: string) => {\n        tokenLogin(token).then((data) => {\n            if(data.data['status'] === 'error') {\n                toast.error('Error. Can\\'t get your account data with this token.', {\n                    position: 'bottom-right',\n                    autoClose: 5000,\n                    hideProgressBar: false,\n                    closeOnClick: true,\n                    pauseOnHover: true,\n                    draggable: true,\n                    progress: undefined,\n                    theme: dark ? 'dark' : 'light',\n                });\n            } else {\n                document.cookie = `access_token=${data.data['data']['access_token']}; path=/; expires=${new Date(Date.now() + 6 * 60 * 60 * 1000).toUTCString()}`;\n                toast.success('Success! Your are now logged.', {\n                    position: 'bottom-right',\n                    autoClose: 5000,\n                    hideProgressBar: false,\n                    closeOnClick: true,\n                    pauseOnHover: true,\n                    draggable: true,\n                    progress: undefined,\n                    theme: dark ? 'dark' : 'light',\n                });\n                navigate('/');\n                window.location.reload();\n            }\n            setLoading(false);\n        });\n    };\n    return (\n        <div className={'flex flex-col items-center justify-center h-full'}>\n            <img src={data.data['google_id'] ? data.data['avatar'] : `https://cdn.discordapp.com/avatars/${data.data['discord_id']}/${data.data['avatar']}.png`} alt='test'\n                onError={({ currentTarget }) => {\n                    currentTarget.onerror = null; // prevents looping\n                    currentTarget.src = `https://ui-avatars.com/api/?background=042049&color=5271ff&name=${data.data['name']}`;\n                } }\n                className={'rounded-md h-64 w-64 my-4'} />\n            <p className={'text-4xl text-black mb-2'}>Login as {data.data['name']}</p>\n            <button className={'flex justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600'} disabled={loading} onClick={() => sendLogin(data.data['access_token'])}>Login</button>\n        </div>\n    );\n};\n\nexport default OauthCallback;"],"names":["config","http","tokenLogin","token","Promise","resolve","reject","post","privateapilink","then","data","catch","React","useState","useNavigate","useSWR","fetcher","toast","Login","Loading","useDark","OauthCallback","dark","loading","setLoading","navigate","urlParams","URLSearchParams","window","location","search","type","get","code","error","isLoading","createElement","message","loginError","sendLogin","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","theme","document","cookie","Date","now","toUTCString","success","reload","className","src","alt","onError","currentTarget","onerror","disabled","onClick"],"sourceRoot":""}