{"version":3,"file":"313.bundle.js","mappings":"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","sources":["webpack://newwebsite/./src/api/auth/tokenLogin.ts","webpack://newwebsite/./src/components/Auth/OauthCallback.tsx"],"sourcesContent":["import { config } from '../../config/config';\nimport http from '../http';\n\n\nconst tokenLogin = (token: string ): Promise<any> => {\n  return new Promise<any>((resolve, reject) => {\n    http\n      .post(`${config.privateapilink}/auth/tokenlogin`, { token })\n      .then((data) => resolve(data))\n      .catch(reject);\n  });\n};\n\nexport default tokenLogin;","import React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport useSWR from \"swr\";\nimport { fetcher } from \"../../api/http\";\nimport tokenLogin from \"../../api/auth/tokenLogin\";\nimport { toast } from \"react-toastify\";\nimport Login from \"./Login\";\nimport Loading from \"../Elements/Loading\";\nimport { config } from \"../../config/config\";\n\nconst OauthCallback = () => {\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n  const urlParams = new URLSearchParams(window.location.search);\n  const type = urlParams.get('type')\n  const code = urlParams.get('code');\n  const {data, error, isLoading} = useSWR(`${config.privateapilink}/auth/oauthloginCallback?token=${code}&type=${type}`, fetcher);\n  if(!data || (error || isLoading)) {\n     return <Loading/>;\n  }\n  if(data['status'] === 'error' || !data.data) {\n    let message = ''\n    if(data['status'] !== 'error') {\n      message = 'A unexcepted error happend.'\n    } else {\n      message = data['message']\n    }\n    return (\n        <Login loginError={message}/>\n    )\n  }\n  const sendLogin = (token: string) => {\n    tokenLogin(token).then((data) => {\n      if(data.data['status'] === 'error') {\n        toast.error('Error. Can\\'t get your account data with this token.', {\n          position: \"bottom-right\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined,\n          theme: (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) ? 'dark' : 'light',\n        });\n      } else {\n        document.cookie = `access_token=${data.data['data']['access_token']}; path=/; expires=${new Date(Date.now() + 6 * 60 * 60 * 1000).toUTCString()}`;\n        toast.success('Success! Your are now logged.', {\n          position: \"bottom-right\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined,\n          theme: (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) ? 'dark' : 'light',\n        });\n        navigate('/');\n        window.location.reload();\n      }\n      setLoading(false)\n    })\n  }\n  return (\n   <div className={'flex flex-col items-center justify-center h-full'}>\n     <img src={data.data['google_id'] ? data.data['avatar'] : `https://cdn.discordapp.com/avatars/${data.data['discord_id']}/${data.data['avatar']}.png`} alt='test'\n          onError={({ currentTarget }) => {\n            currentTarget.onerror = null; // prevents looping\n            currentTarget.src = `https://ui-avatars.com/api/?background=042049&color=5271ff&name=${data.data['name']}`;\n          } }\n          className={'rounded-md h-64 w-64 my-4'} />\n     <p className={'text-4xl'}>Login as {data.data['name']}</p>\n     <button className={'btn btn-primary mt-4 btn-lg'} disabled={loading} onClick={() => sendLogin(data.data['access_token'])}>Login</button>\n   </div>\n  )\n}\n\nexport default OauthCallback"],"names":["config","http","tokenLogin","token","Promise","resolve","reject","post","privateapilink","then","data","catch","React","useState","useNavigate","useSWR","fetcher","toast","Login","Loading","OauthCallback","loading","setLoading","navigate","urlParams","URLSearchParams","window","location","search","type","get","code","error","isLoading","createElement","message","loginError","sendLogin","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","theme","matchMedia","matches","document","cookie","Date","now","toUTCString","success","reload","className","src","alt","onError","currentTarget","onerror","disabled","onClick"],"sourceRoot":""}